<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GENERATION TRANSFORMASI KENDARAAN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #3b44f6; }
        .loading-spinner { border: 4px solid rgba(255,255,255,0.1); border-radius: 50%; border-top: 4px solid #fff; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [vehicleName, setVehicleName] = useState('Yamaha Trail');
            const [modelCount, setModelCount] = useState(5);
            const [category, setCategory] = useState('Motorcycles');
            const [env, setEnv] = useState('cinematic urban highway environment inspired by a modern Southeast Asian capital city');
            const [cam, setCam] = useState('low angle tracking shot, 3/4 front side view');
            const [ratio, setRatio] = useState('9:16');
            const [audio, setAudio] = useState('Aggressive engine roars with cinematic orchestral music');
            const [isLoading, setIsLoading] = useState(false);
            const [results, setResults] = useState(null);

            const apiKey = "AIzaSyD0YcgUE3IgTtwbxBkJVKTMA4_iAwakzek"; // Kunci akan bekerja otomatis jika sudah diisi di Vercel Env

            const categories = [
                { id: 'Motorcycles', label: 'Motor' },
                { id: 'Cars', label: 'Mobil' },
                { id: 'Heavy', label: 'Alat Berat' },
                { id: 'Ships', label: 'Kapal Laut' },
                { id: 'Planes', label: 'Pesawat' }
            ];

            const audios = [
                "Aggressive engine roars with cinematic orchestral music",
                "Cinematic trailer style with deep bass impacts",
                "Aggressive phonk music with loud exhaust pops",
                "Real street ambient with lo-fi hip hop",
                "Vintage mechanical engine with energetic rock",
                "High-pitched futuristic electric motor whirring",
                "No audio, completely silent"
            ];

            const generate = async () => {
                if (!vehicleName) return alert("Masukkan nama kendaraan!");
                setIsLoading(true);
                
                try {
                    // Mencoba memanggil Gemini API melalui window env atau direct
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: `Berikan daftar ${modelCount} model untuk: ${vehicleName} kategori ${category}. Format: Nama (Tahun)` }] }]
                        })
                    });
                    
                    const data = await response.json();
                    const aiText = data.candidates?.[0]?.content?.parts?.[0]?.text || "Model A (1990)\nModel B (2000)";
                    const modelList = aiText.trim().split('\n');

                    setResults({
                        models: modelList,
                        photo: `${aiText}\n\nPhoto Prompt:\n${env}, camera: ${cam}, ${ratio} ratio. Realistic lighting.`,
                        video: `Video Prompt:\nEvolusi transformasi, audio: ${audio}, ${cam}, environment: ${env}.`
                    });
                } catch (e) {
                    setResults({
                        models: [`${vehicleName} Gen 1`, `${vehicleName} Gen 2`],
                        photo: `Photo Prompt: ${env}, ${cam}...`,
                        video: `Video Prompt: Evolusi transition, audio: ${audio}...`
                    });
                }
                setIsLoading(false);
            };

            const copy = (text) => {
                const el = document.createElement('textarea');
                el.value = text;
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                alert("Berhasil disalin!");
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4 md:p-10">
                    <div className="bg-white w-full max-w-5xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col md:row min-h-[600px] md:flex-row">
                        
                        <div className="flex-1 p-8 md:p-12 space-y-6">
                            <div className="mb-8">
                                <h1 className="text-2xl font-black text-blue-800 leading-tight uppercase">Generation Transformasi Kendaraan</h1>
                                <p className="text-slate-400 text-xs font-bold mt-1 tracking-widest">SISTEM AI SIAP PAKAI</p>
                            </div>

                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div className="space-y-1">
                                    <label className="text-[10px] font-black text-slate-400 uppercase">Nama Kendaraan</label>
                                    <input type="text" value={vehicleName} onChange={(e) => setVehicleName(e.target.value)} className="w-full bg-slate-50 border-2 border-slate-100 rounded-xl px-4 py-2 outline-none focus:border-blue-500 font-bold" />
                                </div>
                                <div className="space-y-1">
                                    <label className="text-[10px] font-black text-slate-400 uppercase">Jumlah Model</label>
                                    <select value={modelCount} onChange={(e) => setModelCount(e.target.value)} className="w-full bg-slate-50 border-2 border-slate-100 rounded-xl px-4 py-2 outline-none font-bold">
                                        {[...Array(15)].map((_,i) => <option key={i} value={i+1}>{i+1} Model</option>)}
                                    </select>
                                </div>
                            </div>

                            <div className="flex flex-wrap gap-2">
                                {categories.map(cat => (
                                    <button key={cat.id} onClick={() => setCategory(cat.id)} className={`px-4 py-1.5 rounded-full text-[10px] font-black transition-all ${category === cat.id ? 'bg-blue-600 text-white shadow-lg' : 'bg-slate-100 text-slate-400'}`}>
                                        {cat.label}
                                    </button>
                                ))}
                            </div>

                            <button onClick={generate} disabled={isLoading} className="w-full bg-[#5249f6] text-white py-4 rounded-2xl font-black shadow-xl hover:bg-blue-700 transition-all flex items-center justify-center gap-3 tracking-widest active:scale-95">
                                {isLoading ? <div className="loading-spinner"></div> : "GENERATE SEKARANG"}
                            </button>
                        </div>

                        <div className="w-full md:w-[400px] bg-slate-50 p-8 border-l border-slate-100 flex flex-col">
                            {results ? (
                                <div className="space-y-6 flex-1 flex flex-col">
                                    <div className="flex-1 overflow-auto custom-scroll pr-2">
                                        <h3 className="text-[10px] font-black text-blue-800 uppercase mb-4 tracking-widest">Evolusi {vehicleName}</h3>
                                        <div className="space-y-2 border-l-4 border-blue-200 pl-4">
                                            {results.models.map((m, i) => <p key={i} className="text-xs font-mono font-bold text-slate-600">{m}</p>)}
                                        </div>
                                    </div>
                                    <div className="space-y-3 pt-4">
                                        <button onClick={() => copy(results.photo)} className="w-full bg-purple-600 text-white text-[10px] font-black py-3 rounded-xl hover:bg-purple-700 uppercase tracking-widest">Salin Prompt Foto</button>
                                        <button onClick={() => copy(results.video)} className="w-full bg-red-600 text-white text-[10px] font-black py-3 rounded-xl hover:bg-red-700 uppercase tracking-widest">Salin Prompt Video</button>
                                    </div>
                                </div>
                            ) : (
                                <div className="flex-1 flex flex-col items-center justify-center text-slate-300 space-y-4 text-center">
                                    <div className="w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-inner text-2xl">âœ¨</div>
                                    <div>
                                        <p className="text-xs font-black uppercase tracking-widest">Menunggu Input</p>
                                        <p className="text-[10px]">Lengkapi data di kiri untuk memulai</p>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
